## 04-01

exceljs를 사용해 보았다.  
분명 좋은 라이브러리였다. 하지만 내가 방법을 못찾은 것인지 모르지만 아쉬운 점은 column 또는 row에 데이터를 넣을 때 해당 cell의 데이터는 설정할 수 있지만 style 관련 설정을 해주지 못한다는 점이였다.

```javascript
// ref: https://www.npmjs.com/package/exceljs?source=post_page---------------------------#rows
const rows = [
  [5, "Bob", new Date()], // row by array
  { id: 6, name: "Barbara", dob: new Date() },
];
// add new rows and return them as array of row objects
const newRows = worksheet.addRows(rows);
```

위와 같이 각 row 데이터를 설정할 때 각 cell의 값은 설정할 수 있지만 merge나 style 설정은 못해주었다.
이 때문에 데이터를 가공하는 단계에서 각 객체의 특성에 맞게 style이나 merge 데이터를 객체 데이터로서 가지고 있지 못한다.

```javascript
// ref: https://www.npmjs.com/package/exceljs?source=post_page---------------------------#merged-cells
// merge by top-left, bottom-right
worksheet.mergeCells("K10", "M12");

// merge by start row, start column, end row, end column (equivalent to K10:M12)
worksheet.mergeCells(10, 11, 12, 13);
```

merge를 다음과 같이 worksheet에서 관리해주고 있다.  
따라서 데이터 가공 단계에서 각 객체가 style, merge 데이터를 갖고 있는 것이 아니라 모듈 전역 공간에서 사용하는 registry 객체에서 관리하도록 했다.  
그러면 데이터 가공을 통해 각 rows 데이터가 만들어지고 registry 객체에서는 merge나 style 정보들을 가지고 worksheet을 설정해주도록 유도했다.

- exceljs 인터페이스에 맞는 데이터 가공
- 코어소리영어 신왕국의 '로보카폴리' 8강 9강 학습
- 리팩토링 자바스크립트 책 4-2장 테스트 실습
